<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>How long till Birks by November</title>
  <meta name="theme-color" content="#FFC800" />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-R9TZG1QJ9C"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} 
    gtag('js', new Date());
    gtag('config', 'G-R9TZG1QJ9C');
  </script>

  <style>
    :root {
      --tarp-yellow: #FFC800;
      --fg: #000000;
      --muted: #333333;
      --card: #fff3cc;
    }

    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      background: var(--tarp-yellow);
      color: var(--fg);
      min-height: 100dvh;
      padding: calc(env(safe-area-inset-top, 0) + 16px) 16px calc(env(safe-area-inset-bottom, 0) + 24px);
      display: grid;
      place-items: start center;
      text-align: center;
    }

    main { width: 100%; max-width: 680px; }

    h1 {
      font-size: clamp(2rem, 6vw, 3rem);
      margin: 0 0 .75rem;
      letter-spacing: .01em;
      font-weight: 900;
      text-transform: uppercase;
      text-wrap: balance;
    }

    .kicker { font-size: .95rem; color: var(--muted); margin: 0 0 .75rem; }

    .timer { display: grid; gap: 14px; margin: 1.25rem 0 1.5rem; }
    .cell {
      background: var(--card);
      border: 2px solid var(--fg);
      border-radius: 16px;
      padding: 16px 18px;
      box-shadow: 0 6px 0 rgba(0,0,0,.25);
    }
    .num { font-variant-numeric: tabular-nums; font-size: clamp(2.25rem, 8vw, 3.25rem); font-weight: 900; line-height: 1; }
    .lab { font-size: 1rem; margin-top: .35rem; color: var(--muted); letter-spacing: .12em; text-transform: uppercase; }

    @media (min-width: 720px) {
      .timer { grid-auto-flow: column; }
      .cell { min-width: 120px; }
    }

    .video { margin-top: 1.25rem; }
    .video .frame {
      position: relative; width: 100%; aspect-ratio: 16 / 9; border: 2px solid var(--fg); border-radius: 16px; overflow: hidden; background: #000;
    }
    .video iframe { position: absolute; inset: 0; width: 100%; height: 100%; }

    .credit { margin-top: 20px; font-size: .9rem; font-weight: 700; }

    /* Toggle button, very obvious on mobile */
    #toggle-audio {
      position: fixed;
      right: 16px;
      bottom: 16px;
      background: var(--card);
      border: 2px solid var(--fg);
      border-radius: 14px;
      padding: 12px 18px;
      font-weight: 800;
      box-shadow: 0 6px 0 rgba(0,0,0,.25);
      cursor: pointer;
      z-index: 50;
      display: none;
      transition: transform .06s ease;
    }
    #toggle-audio:active { transform: translateY(2px); }
    #toggle-audio:hover { background: #ffe670; }

    /* Mobile prominence */
    @media (max-width: 720px) {
      #toggle-audio {
        left: 16px;
        right: 16px;
        width: auto;
        min-height: 52px;
        font-size: 1rem;
        padding: 14px 18px;
      }
    }

    .sr-only { 
      position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; 
      overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; 
    }
  </style>
</head>
<body>
  <main>
    <h1>How long till Birks by November</h1>
    <p class="kicker">Target timezone: <strong>Australia/Melbourne</strong></p>

    <div class="timer" aria-live="polite" aria-atomic="true">
      <div class="cell"><div class="num" id="days">0</div><div class="lab">Days</div></div>
      <div class="cell"><div class="num" id="hours">0</div><div class="lab">Hours</div></div>
      <div class="cell"><div class="num" id="mins">0</div><div class="lab">Minutes</div></div>
      <div class="cell"><div class="num" id="secs">0</div><div class="lab">Seconds</div></div>
    </div>

    <div class="video" aria-labelledby="vidtitle">
      <span id="vidtitle" class="sr-only">Embedded YouTube video</span>
      <div class="frame">
        <iframe src="https://www.youtube.com/embed/WvDnRS448RI" title="YouTube video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
    </div>

    <p class="credit">Built by Charles. But all Copyright remains Toni and Ryan, as he was working when he built it.</p>
  </main>

  <!-- Background music -->
  <audio id="bgm" src="BIRKS BY NOVEMBER_v1.mp3" preload="metadata" loop></audio>
  <button id="toggle-audio" aria-pressed="false" aria-label="Play or pause site theme">▶ Play theme</button>

  <script>
    // Countdown timer
    function targetDate() {
      const now = new Date();
      const y = now.getFullYear();
      let target = new Date(`${y}-11-01T00:00:00+11:00`);
      if (now.getTime() > target.getTime()) target = new Date(`${y + 1}-11-01T00:00:00+11:00`);
      return target;
    }

    const $ = id => document.getElementById(id);
    let tgt = targetDate();

    function pad(n) { return String(n).padStart(2, '0'); }

    function render() {
      const now = new Date();
      const diff = Math.max(0, tgt.getTime() - now.getTime());
      const s = Math.floor(diff / 1000);
      const days = Math.floor(s / 86400);
      const hours = Math.floor((s % 86400) / 3600);
      const mins = Math.floor((s % 3600) / 60);
      const secs = s % 60;

      $('days').textContent = days;
      $('hours').textContent = pad(hours);
      $('mins').textContent = pad(mins);
      $('secs').textContent = pad(secs);

      if (diff <= 0) {
        document.querySelector('h1').textContent = 'It is 1 November';
        clearInterval(timer);
      }
    }

    const timer = setInterval(render, 1000);
    render();

    // Audio bootstrap with graceful fallback
    const audioEl = document.getElementById('bgm');
    const toggleBtn = document.getElementById('toggle-audio');
    audioEl.volume = 0.4;

    // Try autoplay. If blocked, reveal the control as Play.
    audioEl.play().then(() => {
      // Autoplay succeeded, keep button hidden. User can still use media keys.
    }).catch(() => {
      // Autoplay blocked, show prominent Play button.
      toggleBtn.style.display = 'inline-block';
      toggleBtn.textContent = '▶ Play theme';
      toggleBtn.setAttribute('aria-pressed', 'false');
    });

    // Toggle behaviour. Once pressed the first time, keep the button visible for pause.
    toggleBtn.addEventListener('click', () => {
      if (audioEl.paused) {
        audioEl.play().then(() => {
          toggleBtn.textContent = '⏸ Pause theme';
          toggleBtn.setAttribute('aria-pressed', 'true');
        });
      } else {
        audioEl.pause();
        toggleBtn.textContent = '▶ Play theme';
        toggleBtn.setAttribute('aria-pressed', 'false');
      }
    });

    // Also update label when playback changes by other means.
    audioEl.addEventListener('play', () => {
      toggleBtn.textContent = '⏸ Pause theme';
      toggleBtn.setAttribute('aria-pressed', 'true');
    });
    audioEl.addEventListener('pause', () => {
      toggleBtn.textContent = '▶ Play theme';
      toggleBtn.setAttribute('aria-pressed', 'false');
    });
  </script>
</body>
</html>
